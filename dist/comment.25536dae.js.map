{"version":3,"sources":["comment-component.ts","time-ago.ts","measure.ts","timeline-component.ts","deparam.ts","comment.ts"],"names":[],"mappings":";;AKAA;;AACA;;AACA,AJFA,IAAM,UAAU,GAAG,CAAC,IAAD,EAAO,GAAP,EAAY,OAAO,EAAnB,EAAuB,GAAvB,EAA4B,OAAO,EAAP,GAAY,EAAxC,EAA4C,GAA5C,EAAiD,OAAO,EAAP,GAAY,EAAZ,GAAiB,EAAlE,EAAsE,GAAtE,EAA2E,OAAO,EAAP,GAAY,EAAZ,GAAiB,EAAjB,GAAsB,CAAjG,EAAoG,GAApG,EAAyG,OAAO,EAAP,GAAY,EAAZ,GAAiB,EAAjB,GAAsB,EAA/H,EAAmI,GAAnI,CAAnB;ACKA,ADHA,AEFA,IDKI,ADHE,UCGN,GDHmB,GAA+B;AIClD,ADHM,AHE8C,EAAA,KAAK,EGFzC,AHE2C,OGFrD,AHE4C,CGF1B,KAAlB,EAA+B;AACnC,AFMI,ADL8D,AEDpE,EFCoE,GAAG,CGDjE,CHCmE,ECKzD,EENd,KHCgD,OCK5C,CAAyB,MAAzB,EAAuC;AGH7C,ADFE,AFMA,ADNkF,ECMlF,ADNkF,EIEpF,EDFQ,AHAgF,EAAE,EGA9E,EFMA,CGJZ,ADFe,EFMA,CGJf,EDFE,GFMA,OGJF;AASE,ADVA,AFMA,ADPgD,AEAlD,CFAA,CCOE,IENM,KCUN,CDVY,GAAG,GFMC,CAAC,CGIjB,GAAA,IHJgB,EAAW,MEN3B,SFMgB,CAAhB;AGIA,AHHA,EAAA,MGGA,KAAA,GAAA,EHHgB,CAAC,CGGjB,KHHgB,EAAS,eAAT,CAAhB;AENA,AFOD,ADPK,AEDN,IAAA,ECCQ,GHAQ,GGAF,GAAG,CHAX,CAAkB,KAAlB,CEDN,CCCQ,AHA6B,EEDrC,ICCiB,CAAC,CAAD,EAAU,IDD3B;AEKU,ADJsB,AHC/B,AEIC,MFJG,GIGK,CJHD,CGDuB,ADK9B,EFJe,EIGP,EJHW,CIGe,GJHnB,CAAS,KAAT,CAAhB,CGDiD,CAAC,ADKjD,CCLkD,ADKvB,CCLwB,KDKnD,ECLiD,ADKC,CCLS,IAAV,EAAgB,GAAhB,CAAD,CAAlB;ACK5B,ADLoE,AFSxE,ADPE,AEGA,GCLA,CFSE,EGJA,AJHI,EEGN,GEAO,EAAE,AJHI,AEGb,CDIY,EDPI,AEGhB,CDIe,CAAC,CAAlB,CGLoC,AJFd,AEGpB,IFHgB,GAAW,OAAX,KAAuB,IAAI,IAAJ,CAAS,KAAT,EAAgB,OAAhB,EAAvC;AIIE,MAAA,KAAK,EAAE;AAFyB,ADHlC,AFUF,ADRE,AEE2B,KEDnB,CDHF,AHEF,GCQG,ACNoB,GCJf,CHED,EGF4B,ADIZ,CDM7B,ADRgB,CGFd,CDI2B,CDMb,CDRd,EAAoB,EEEO;AEKzB,AHEF,ADRE,AEFM,MDUF,GGFC,AFRC,EFEC,CCQG,CCVJ,EDUO,ADRb,CEFqB,CAAf,CEQN,GAAiB,EHEI,CAAC,IAAT,CGFY,AHEE,CGFD,WHEb,EGFI,CAAuB,AHEE,EAA5C,GGFmB,CAAjB;AACA,ADRF,AHEC,AEFO,IEQN,KDRK,ADAC,GEQE,CAAC,CDRC,EDAJ,CEQN,ADRa,CCQC,CFRW,ICAN,CAAC,ADAd,ICAO,CCQb,ADRyB,CCQC,IDRb,CCQkB,ADRjC,EAAmC,OCQjC;AACA,ADRA,AFSF,ACPE,ICFA,EFSE,EGDE,CFNC,CCFC,CAAC,CFSC,EGDE,EFNV,CEMa,ADRA,AFSA,CETC,CDEC,ICFI,CAAC,CAAD,CAAN,CAAP,AFSR,ACPyB,CCFvB,ADEwB,CDOC,EETE,MAAM,CAAC,CCQb,EFNN,CAAuB,CCFC,CAAC,CAAD,CAAN,CCQJ,ADR7B,ADEe,CEMe,AFN9B,MEMqB,CAAgB,OAAhB,CAAwB,GAAxB,EAA6B,EAA7B,CAAR,CAAb;ADPD,AFSC,ADRF,AECE,MFDE,CAAC,EECE,CFDC,CAAR,KECE,CAAa,SAAb,GAAyB,iBAAzB;AEMA,AHED,ACPC,QEKI,CAAC,AFLA,KEKK,MFLV,GEKA,AFLmB,EEKE,EFLE,oCAAJ,CAAuB,KAAK,MAA5B,CAAnB;AHZJ,AKkBM,ADRJ,AHCA,AEGE,IHdE,EKkBA,GDRG,AHCA,AEGA,CFHC,GIOG,AJPA,CIOC,AJPL,CGDP,CJVgB,AGcd,CFHa,EDXY,AKkBvB,AFJa,CEIC,OJPO,AEGA,CFHC,AEGA,CEItB,KJPG,EDXT,ECWsC,GEGnB,CAAuB,GFHG,EEG1B,CFH6B,AEG5C,GFHkC,GAAgB,UAAU,CAAC,CAAC,GAAG,CAAL,CAA9D,EAAuE;AIQpE,ADRJ,AFSC,ADRE,AEGA,EDKF,EDRE,CAAC,IAAI,AEGA,CFHL,ECQQ,GAAG,CCLX,CAAa,IDKf,CCLE,CAAmB,SAAnB,GAA+B,QAA/B;AHdJ,AEoBE,ADRC,AEGC,IHfJ,EEoBQ,GCLC,IDKM,GAAkB,ACL7B,CAAa,KHfjB,GAAA,CGeI,GAAyB,QHf7B,sDGeI;AHHF,AKOE,ADPE,AFQ6B,ACJ/B,IDI+B,IAAI,CERvB,ADIP,CDIgC,CFRvC,GIAI,CAAgB,CDIlB,CAAa,CCJX,AFQ2B,EERgB,SJA/C,CAA2B,AGIzB,CAA2B,EEGZ,GLPjB,EAAkD,CKO3B,CAAC,EFHtB,EAAyC,EEGzC,cFHA,CAA0D,OAA1D,EAAmE,YAAA;AEInE,ADPF,AFOiD,ADNjD,AEGI,IDG6C,EEP3C,AHCA,AEGF,GEGG,CHAgD,CEP5C,ADIH,CDG+C,ACH9C,CFHI,CGDC,EAAd,AHCgB,AEGZ,EEGF,CAAe,OJNS,CAAC,CIMzB,AJNwB,CAA1B,EIM6B,sBAA3B;AACA,AHD6B,ADL/B,GCKA,GDLM,GIMC,CJNG,GAAG,EIMX,CAAY,KAAZ,EJNqB,CIMD,AJNE,CAAC,GAAG,CAAL,CIMK,AJN5B,CIM6B,KAAP,IAAgB,OAApC;ALTyB,AKUzB,ADRF,AFOA,ADLA,AEEI,EDGJ,IDLM,AEEF,CCJC,CFOC,CFTqB,AKUpB,AHDA,EEPI,AHEA,AEEH,CAAC,EFFK,CDJa,AKUzB,ADRF,CCQc,ELVa,ACIT,CGFC,AHEA,AEEf,CDGJ,CGCE,AHDiB,CEPnB,EJF2B,AKUL,ADRE,AHEV,CAAW,GCKzB,EGC4B,AHDA,CGCC,CJNG,GAAG,CIMb,IAAgB,AHDtC,EDLc,CAAd,KIM8C,CAAC,QAA7C;ALbM,AKcN,ADRA,AFOH,ACHI,KAHD,GCDI,CJNE,AKcD,EDRE,CAAC,CCQR,GAAY,GLdN,CKcN,CAAiB,CLdW,IIMxB,CJNE,AIMiB,IAAnB,ECQa,GDRe,GAAG,CAAC,IAAD,CAAnC,EAA2C;AJF3C,AIGE,AHEJ,AEEE,MCJE,AHEA,GDLG,AGOA,ECJE,AHEA,CGFC,EHEE,CDLV,ACKE,CGFA,ADIF,CCJgB,ADIH,CHPC,CCKC,CAAC,IDLhB,CCKqB,QEErB,CAA8B,CCJI,AHEH,CGFI,AHEH,IGFE,CAAlB,ADIhB,CFFqB,CEEkB,CCJC,CHEC,CAA3C,CGFkB,CHE4B,EGFA,GDIJ,KAAD,EAAa,QCJU,CAAC,GAAG,CAAC,IAAD,CAAJ,CAA5D;AJFF,AIGC,AFOL,ADLI,ICKA,KFVK,ECKE,ICKI,ADLA,CDLX,ACKY,ECKE,CFVC,AEUnB,QFV2B,CAAC,MCKjB,CAAwB,MDLhB,CAAuB,ECK/B,EAAmC,EDL3B,CAAf,UCKO,CAAP;ADJA,AKSE,ADNH,AHEA,MIIG,GLTG,EKSC,CAAC,ILTP,CAAa,SAAb,EKSE,CLTuB,EKSC,IAAI,WLT9B,yBKS0B,CAAuB,KAAI,CAAC,MAA5B,CAAxB;ALRF,AKSE,AHCA,ACLA,OEIA,ELTG,AKSH,AHCU,CCLN,EEIJ,ILTF,AGKY,CHLC,AKSP,CAAC,CFJqB,IHL5B,CEUE,ACL+B,CAAC,CHLZ,CKSpB,AHCyB,ICLzB,EEIc,IAAd,ELTF,EKSgB,EAAA,KAAA,KAAA,CAAd,GAAc,KAAA,CAAd,GAAc,EAAA,CAAE,WAAF,CAAc,KAAI,CAAC,gBAAL,CAAsB,OAApC,CAAd;ALRF,AKSE,ADPJ,AFQA,ADNA,MIKI,AHCE,GFVC,AIEA,AFQE,ADNF,EIKC,CAAC,AHCG,EERA,AHEF,CGFG,CJFX,AEUc,CFVD,AEUE,EERV,AHEA,CGFW,AFQN,EAAZ,ADNkB,CGFX,CAAP,EJFE,ACIK,GDJoB,AKSvB,AJLkB,GIKO,IAAI,CJLjC,qCIK6B,CAAwB,KAAI,CAAC,MAA7B,CAAzB,81BLTF;AAoBA,AKVE,ADPL,AHEA,AEAK,OEKA,ELUG,AKVH,CFLI,EEKJ,IFLU,CEKN,AFLO,CEKN,ILUP,GAAqB,CGff,CEKJ,GLUwB,AGfA,GEKV,ILUK,AKVnB,CLUgC,GKVlB,AFLd,EEKc,AFLuB,KEKvB,GLUK,CAA2B,CKVhC,CAAd,GAAc,KAAA,CAAd,GAAc,EAAA,CAAE,KLUG,CAArB,KKVgB,CAAc,KAAI,CAAC,iBAAL,CAAuB,OAArC,CAAd;ALWF,AEVF,ACLM,MDKF,GFUG,AEVA,GAAG,ACLA,CAAA,EAAA,EHeR,CGfQ,EHeQ,GEVd,CCLY,CHeO,AGfN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GLgBiB,CKhBjB,ULgBE;AACD,AGrBA,GHmBM;AKdL,WAAO,IAAI,OAAJ,CAAY,UAAC,OAAD,EAAQ;ALkBrB,AKjBJ,AFJG,EHqBC,AGrBD,QEIG,IAAI,GAAG,GLiBT,CAAA,AGrBD,CAAA,GEIkB,CAAC,ILiBlB,CAAA,AGrBD,CAAA,OHqBC,AKjBS,AFJV,CEIiC,ELiBxC,AGrBA,IEIiB,CAAb,KFJW,EHqBf,EGrBA,EAA4B;AHsB1B,AKjBE,AFLJ,MEKI,ELiBE,AGtBN,EEKQ,CAAC,CLiBC,CGtBV,CEKI,CLiB4B,CGtBhC,CEKe,GFLf,SEKI;ALkBA,AKjBA,MLiBA,AKjBA,IAAI,CAAC,GLiBG,EAAE,KAAK,EKjBf,CAAkB,ULiBR,CAAmB,EKjB7B,EAAiC,CLgBL,UKhB5B;ALkBA,AKjBA,AFNF,MHuBE,AKjBA,EFNE,EHuBE,AKjBA,CAAC,CLiBC,CGvBC,IHuBI,AKjBX,GAAc,AFNZ,IAAgB,EHuBZ,CAAe,AKjBrB,CFNF,EAA0B,EHqBI;AAG5B,AKjBA,AFNF,MHuBE,AKjBA,GFNG,CHuBC,AKjBA,CAAC,CLiBC,GKjBN,CFNF,CHuBa,CKjBC,CFNC,IAAf,GHuBQ,CAAe,YKjBU,KAAI,CAAC,MAAL,CAAY,KAA/B,GAAoC,MAAhD;ALc4B,AKb5B,AFNF,IAAA,CHmBA,CKbE,EFNE,GAAG,GEMG,CAAC,AFNA,IEMT,AFNa,CEMC,IFNI,IAAb,GEML,CAA0B,AFNA,CAA5B,GEME;ALkBF,AKjBC,ILiBD,CKxBO,CAAP,ILwBM,CAAC,YAAP,CAAoB,OAApB,CAA4B,YAA5B,EAA0C,IAAI,CAAC,SAAL,CAAe,IAAf,CAA1C;AACA,AKjBD,AFNC,GEHM,KFGF,GHuBJ,CGvBQ,IAAI,CAAZ,EHuBA,AGvBe,CHuBf,QAAA,CAAA,EAAA,EACK,IADL,CAAA,EACS;AACP,AGxBA,MHwBA,KGxBK,GHwBG,EAAE,EGxBV,CAAa,GHwBG,CAAC,KAAK,AGxBtB,GAAyB,EAAzB,QHwBiB,CAAmB,KAApB,CADT;AAEP,AKnBN,AFLK,MHwBC,GAAG,AKnBT,ELmBW,MAAM,CAAC,AKnBlB,KLmBuB,QAAL,CAAc,KAAf,CAFJ;AAGP,AKnEN,CAAA,EAAA,GLmEM,OAAO,EAAE,KAAK,YAAL,CAAkB,KAHpB;AAIP,AGzBF,MHyBE,EGzBE,UHyBU,AGzBA,EHyBE,CGzBC,IHyBI,IGzBI,CAAC,CHyBV,CAAY,KAJnB,MGrBQ,CAAuB,KAAvB,CAAjB;AH0BE,AKpBN,AFLI,IEKA,AFLA,EHyBE,OAAO,AKpBb,CFLc,CHyBC,AGzBA,GHyBG,CAAC,KGzBf,GHyBW,AGzBY,CHyBC,IALf,siCGpBT;AH0BE,AGdF,MHcE,GGdG,MHcM,CGdX,CHca,AGdA,GHcG,CAAC,OGdjB,CHca,AGdY,CHcC,SGd1B;AHQS,AGPT,KHMA,CAAA,EGNI,MAAM,GAAG;AHed,AGdG,GHFI,GGEJ,KAAK,EAAE,KAAK,MAAL,CAAY,KADR;AAEX,MAAA,IAAI,EAAA;AHeA,AGjBO,EHiBP,GGjBN,eHiBM,CAAA,SAAA,CAAA,eAAA,GAAR,UAAwB,KAAxB,EAAoC;AAApC,AGbE,IAAA,IHaF,CGbO,CACF,GHYL,AGbE,CACO,EHYT,IAAA,IGbE,EACmB;AACf,MAAA,MAAM,EAAA;AHYV,AGbmB,IHanB,CGdA,EAIG,EHUE,CAAC,CGdN,CAIQ,UAAC,EHUT,CGVQ,EAAS;AACb,MAAA,KAAI,CAAC,OAAL,GAAe,KAAf;AHUJ,QAAI,KAAK,UAAT,EAAqB;AACnB,AGVE,MAAA,KAAI,CAAC,OAAL,CAAa,WAAb,CAAyB,UAAzB;AHWH;AGVG,UAAI,GAAG,CAAC,IAAJ,CAAS,IAAT,IAAiB,GAArB,EAA0B;AHW9B,AGVM,SHUD,GGVK,IAAI,GHUd,AGViB,GHUC,AGVE,CAAC,GHUrB,CGViB,CAAS,IAApB;AHWN,AGVM,SHUD,GGVK,MHUV,CAAe,AGVE,GAAG,KHUpB,GAA0B,AGVE,CAAC,GHU7B,UGVoB,CAAuB,KAAvB,CAAd;AHWN,AGVM,IHUN,IGVM,CHUD,CAAC,IAAN,CAAW,AGVE,CAAC,SAAR,GHUN,AGV0B,EHUA,GGVI,CAAC,CHUA,QAAL,EAA1B,EAA2C,IAA3C,AGV0B,CHUsB,AGVC,IAAI,CAAC,KHUL,EGVvB,CHUsB,AGV1C,EHUmD;AACvD,MAAA,KAAI,CAAC,SAAL,CAAe,QAAf,GAA0B,KAA1B;AACA,AGXI,MHWJ,EGXI,GHWA,CAAC,CGXG,CAAC,OAAL,CHWJ,AGXiB,GHWC,KAAlB,GGXI,CAAyB,OAAzB;;AHYJ,AGXI,UHWA,EGXI,CHWD,CAAC,EGXI,CAAC,CHWT,CAAS,EGXL,EHWJ,CGXgB,GHWC,CGXG,CAAC,CHWzB,EAA0B,KGXlB,GAA4B,IAAI,CAAC,KAArC,EAA4C;AHY9C,AGXI,QHWJ,EGXI,GHWA,CAAC,CGXG,CAAC,KHWT,EGXI,CAAa,CHWD,KAAI,CAAC,IGXjB,CAAyB,EHWb,EAAhB,CGXiC,CAAC,OAA9B;AHYJ,AGXG,QHWH,KAAI,CAAC,YAAL,CAAkB,KAAlB,GAA0B,EAA1B;AACD;AACF,AGZK,KHKN;AAQA,AGZK,WHYE,KAAP;AACD,AGZI,GHJG,EGbN;AAkBD,GA5CM;AHyDC,EAAA,kBAAA,CAAA,SAAA,CAAA,UAAA,GAAR,YAAA;AACE,AGZM,EAAA,OHYD,QAAL,CAAc,GAAd,AGZM,CAAA,CHYa,GAAnB,KGZM,CAAA,iBAAA,GAAR,UAA0B,IAA1B,EAAiD,KAAjD,EAAkE;AHajE,AGbD,GHWQ,KGXR,KAAA,GAAA,IAAA;;AHeO,AGf0C,EHe1C,MGf0C,KAAA,KAAA,EHe1C,CAAA,EGf0C,CAAA,EAAA,IHe1C,CAAA,QAAA,GAAP,UAAgB,QAAhB,EAAkC,GAAlC,EAA6C;AAC3C,AGhB+C,MAAA,GHgB1C,EGhB0C,GAAA,CAAA,EHgB/C,CAAc,KAAd,GAAsB,GAAtB;AACA,AGjBgE,SHiB3D,aAAL,CAAmB,KAAnB,GAA2B,QAA3B;AACD,GAHM;AGdL,WAAO,IAAI,CAAC,MAAL,CAAY,UAAC,IAAD,EAAe,IAAf,EAAkC;AHkBzD,AGjBM,SHiBN,CGjBU,GAAG,GAAG,KAAK,IAAI,CAAT,CHiBhB,EGjB6B,IAAI,CAAC,EAAlB,GAAuB,KAAjC;AHtFN,AGuFM,CHvFN,EAAA,GGuFM,IAAI,IAAI,4IAGkC,GAAG,CAAC,IAAI,CAAC,IAAN,CAHrC,GAGgD,gKAHhD,GAOqB,sBAAQ,IAAI,CAAC,SAAb,CAPrB,GAO4C,oFAP5C,GAQkD,IAAI,CAAC,IARvD,GAQ2D,KAR3D,GAQgE,IAAI,CAAC,QARrE,GAQ6E,6EAR7E,GAU6B,IAAI,CAAC,OAVlC,GAUyC,sFAVzC,GAW2D,IAAI,CAAC,EAXhE,GAWkE,gBAXlE,GAWiF,GAXjF,GAWoF,0HAXpF,IAcN,KAAK,CAAC,OAAN,CAAc,IAAI,CAAC,MAAnB,IAA6B,KAAI,CAAC,iBAAL,CAAuB,IAAI,CAAC,MAA5B,EAAoC,GAApC,CAA7B,GAAwE,EAdlE,IAcoE,oCAd5E;AAiBA,aAAO,IAAP;AACD,KApBM,EAoBJ,EApBI,CAAP;AAqBD,GAtBO;;AAuBV,SAAA,mBAAA;AAzGA,CAAA,EAAA","file":"comment.25536dae.js","sourceRoot":"..\\client","sourcesContent":["const STORAGE_NAME: string = \"kb-comment-user\";\r\nexport class KBCommentComponent {\r\n  public element: HTMLFormElement;\r\n  private parentIdField: HTMLInputElement;\r\n  private rIdField: HTMLInputElement;\r\n  private nickNameField: HTMLInputElement;\r\n  private mailField: HTMLInputElement;\r\n  private siteField: HTMLInputElement;\r\n  private contentField: HTMLTextAreaElement;\r\n  private submitBtn: HTMLButtonElement;\r\n  private submitting: boolean = false;\r\n  private success?: Function;\r\n\r\n  public constructor(private config: KBCommentConfig) {\r\n    this.config = config;\r\n    this.element = document.createElement(\"form\");\r\n    this.element.className = \"kb-comment-form\";\r\n    this.element.action = \"javascript:\";\r\n    this.element.innerHTML = `\r\n      <input type=\"hidden\" name=\"parentId\" value=\"0\" />\r\n      <input type=\"hidden\" name=\"rId\" value=\"0\" />\r\n      <div class=\"user-info clearfix\">\r\n        <div class=\"input-col\">\r\n          <input type=\"text\" name=\"nickname\" maxlength=\"40\" placeholder=\"昵称(必填)\" required/>\r\n        </div>\r\n        <div class=\"input-col\">\r\n          <input type=\"email\" name=\"mail\" placeholder=\"邮箱(必填)\" required/>\r\n        </div>\r\n        <div class=\"input-col\">\r\n          <input type=\"url\" name=\"site\" maxlength=\"40\" placeholder=\"网址\" />\r\n        </div>\r\n      </div>\r\n      <div class=\"message\">\r\n        <textarea row=\"6\" name=\"content\" placeholder=\"请输入你的留言\" required></textarea>\r\n      </div>\r\n      <div class=\"btn-group\">\r\n        <button type=\"submit\">评论</button>\r\n      </div>`;\r\n    this.parentIdField = this.element.querySelector(\"input[name=parentId]\") as HTMLInputElement;\r\n    this.rIdField = this.element.querySelector(\"input[name=rId]\") as HTMLInputElement;\r\n    this.nickNameField = this.element.querySelector(\"input[name=nickname]\") as HTMLInputElement;\r\n    this.mailField = this.element.querySelector(\"input[name=mail]\") as HTMLInputElement;\r\n    this.siteField = this.element.querySelector(\"input[name=site]\") as HTMLInputElement;\r\n    this.contentField = this.element.querySelector(\"textarea\") as HTMLTextAreaElement;\r\n    this.submitBtn = this.element.querySelector(\"button[type=submit]\") as HTMLButtonElement;\r\n    this.element.querySelector(\"a.reset-reply\")?.addEventListener(\"click\", this.resetReply.bind(this));\r\n    this.element.addEventListener(\"submit\", this.onSubmitComment.bind(this), false);\r\n\r\n    let info: KBCommentUserInfo = JSON.parse(window.localStorage.getItem(STORAGE_NAME) || \"null\") as KBCommentUserInfo;\r\n    if (info) {\r\n      this.nickNameField.value = info.nickName;\r\n      this.mailField.value = info.mail;\r\n      this.siteField.value = info.site;\r\n    }\r\n  }\r\n\r\n  public setEvent(successFunc: Function) {\r\n    this.success = successFunc;\r\n  }\r\n\r\n  private getModel() {\r\n    let info: KBCommentUserInfo = {\r\n      nickName: this.nickNameField.value,\r\n      mail: this.mailField.value,\r\n      site: this.siteField.value,\r\n    };\r\n    window.localStorage.setItem(STORAGE_NAME, JSON.stringify(info));\r\n    return {\r\n      ...info,\r\n      parentId: Number(this.parentIdField.value),\r\n      rId: Number(this.rIdField.value),\r\n      content: this.contentField.value,\r\n      articleToken: this.config.token,\r\n      pageUrl: top.location.href,\r\n      pageTitle: top.document.title,\r\n    }; \r\n  }\r\n\r\n  private onSubmitComment(event: Event) {\r\n    event.preventDefault();\r\n    if (this.submitting) {\r\n      return;\r\n    }\r\n    this.submitting = true;\r\n    this.submitBtn.disabled = true;\r\n    axios.post(\"api/comment\", this.getModel()).then((res: any) => {\r\n      this.submitBtn.disabled = false;\r\n      this.submitting = false;\r\n      if (res.data.code == 200) {\r\n        this.success && this.success();\r\n        this.contentField.value = \"\";\r\n      }\r\n    });\r\n    return false;\r\n  }\r\n\r\n  private resetReply() {\r\n    this.setReply(\"0\", \"0\");\r\n  }\r\n\r\n  public setReply(parentId: string, rId: string) {\r\n    this.rIdField.value = rId;\r\n    this.parentIdField.value = parentId;\r\n  }\r\n}\r\n","const thresholds = [1000, \"秒\", 1000 * 60, \"分\", 1000 * 60 * 60, \"时\", 1000 * 60 * 60 * 24, \"天\", 1000 * 60 * 60 * 24 * 7, \"周\", 1000 * 60 * 60 * 24 * 27, \"月\"];\r\n\r\nconst formatOptions: Intl.DateTimeFormatOptions = { month: \"short\", day: \"numeric\", year: \"numeric\" };\r\n\r\nexport function timeAgo(value: string) {\r\n\tlet date:Date = new Date(value);\r\n  const elapsed = new Date().getTime() - new Date(value).getTime();\r\n  if (elapsed < 5000) {\r\n    return \"刚刚\";\r\n  }\r\n  let i = 0;\r\n  while (i + 2 < thresholds.length && elapsed * 1.1 > thresholds[i + 2]) {\r\n    i += 2;\r\n  }\r\n\r\n  const divisor = thresholds[i] as number;\r\n  const text = thresholds[i + 1] as string;\r\n  const units = Math.round(elapsed / divisor);\r\n\r\n  if (units > 3 && i === thresholds.length - 2) {\r\n    return date.toLocaleDateString(undefined, formatOptions);\r\n  }\r\n  return `${units}${text}前`;\r\n}\r\n","export interface ResizeMessage {\r\n  type: \"resize\";\r\n  height: number;\r\n}\r\n\r\nlet hostOrigin: string;\r\n\r\nexport function startMeasuring(origin: string) {\r\n  hostOrigin = origin;\r\n  addEventListener(\"resize\", scheduleMeasure);\r\n  addEventListener(\"load\", scheduleMeasure);\r\n}\r\n\r\nlet lastHeight = -1;\r\n\r\nfunction measure() {\r\n  const height = document.body.scrollHeight + 60;\r\n  if (height === lastHeight) {\r\n    return;\r\n  }\r\n  lastHeight = height;\r\n  const message: ResizeMessage = { type: \"resize\", height };\r\n  parent.postMessage(message, hostOrigin);\r\n}\r\n\r\nlet lastMeasure = 0;\r\n\r\nexport function scheduleMeasure() {\r\n  const now = Date.now();\r\n  if (now - lastMeasure > 50) {\r\n    lastMeasure = now;\r\n    setTimeout(measure, 50);\r\n  }\r\n}\r\n","import { KBCommentComponent } from \"./comment-component\";\r\nimport { timeAgo } from \"./time-ago\";\r\nimport { scheduleMeasure } from \"./measure\";\r\nexport class KBTimeLineComponent {\r\n  public element: HTMLDivElement;\r\n  private moreDOM: HTMLDivElement;\r\n  private page: number = 1;\r\n  private loading: boolean = false;\r\n  private commentComp: KBCommentComponent;\r\n  public constructor(private config: KBCommentConfig) {\r\n    this.element = document.createElement(\"div\");\r\n    this.element.className = \"kb-comment-list\";\r\n    this.commentComp = new KBCommentComponent(this.config);\r\n\r\n    this.moreDOM = document.createElement(\"div\");\r\n    this.moreDOM.style.textAlign = \"center\";\r\n    this.moreDOM.innerHTML = `<button class=\"more-btn\">加载更多</button>`;\r\n    this.moreDOM.querySelector(\".more-btn\")!.addEventListener(\"click\", () => {\r\n      this.page++;\r\n      this.getList();\r\n    });\r\n    this.element.addEventListener(\"click\", (event: Event) => {\r\n      let target: HTMLElement = event.target as HTMLElement;\r\n      if (target.className == \"reply-btn\") {\r\n        if (target.parentNode?.contains(this.commentComp.element)) {\r\n          target.parentNode?.removeChild(this.commentComp.element);\r\n        } else {\r\n          target.parentNode?.appendChild(this.commentComp.element);\r\n          this.commentComp.setReply(target.dataset.pid || \"\", target.dataset.rid || \"\");\r\n          this.commentComp.setEvent(() => {\r\n            target.parentNode?.removeChild(this.commentComp.element);\r\n            this.getList();\r\n          });\r\n        }\r\n        scheduleMeasure();\r\n      }\r\n    });\r\n  }\r\n\r\n  public getList(page?: number) {\r\n    if (this.loading == true) return;\r\n    this.loading = true;\r\n    page = page || this.page || 1;\r\n    // this.element.removeChild(this.moreDOM);\r\n    if (page == 1) {\r\n      this.element.innerHTML = \"\";\r\n    }\r\n    let loadingDOM = document.createElement(\"div\");\r\n    loadingDOM.innerHTML = `<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" style=\"margin: auto; display: block; shape-rendering: auto;\" width=\"80px\" height=\"80px\" viewBox=\"0 0 100 100\" preserveAspectRatio=\"xMidYMid\">\r\n    <circle cx=\"30\" cy=\"50\" fill=\"#1d3f72\" r=\"20\">\r\n      <animate attributeName=\"cx\" repeatCount=\"indefinite\" dur=\"1s\" keyTimes=\"0;0.5;1\" values=\"30;70;30\" begin=\"-0.5s\"></animate>\r\n    </circle>\r\n    <circle cx=\"70\" cy=\"50\" fill=\"#5699d2\" r=\"20\">\r\n      <animate attributeName=\"cx\" repeatCount=\"indefinite\" dur=\"1s\" keyTimes=\"0;0.5;1\" values=\"30;70;30\" begin=\"0s\"></animate>\r\n    </circle>\r\n    <circle cx=\"30\" cy=\"50\" fill=\"#1d3f72\" r=\"20\">\r\n      <animate attributeName=\"cx\" repeatCount=\"indefinite\" dur=\"1s\" keyTimes=\"0;0.5;1\" values=\"30;70;30\" begin=\"-0.5s\"></animate>\r\n      <animate attributeName=\"fill-opacity\" values=\"0;0;1;1\" calcMode=\"discrete\" keyTimes=\"0;0.499;0.5;1\" dur=\"1s\" repeatCount=\"indefinite\"></animate>\r\n    </circle>\r\n    </svg>`;\r\n    this.element.appendChild(loadingDOM);\r\n    let params = {\r\n      token: this.config.token,\r\n      page,\r\n    };\r\n    axios\r\n      .get(\"api/page\", {\r\n        params,\r\n      })\r\n      .then((res: any) => {\r\n        this.loading = false;\r\n        this.element.removeChild(loadingDOM);\r\n        if (res.data.code == 200) {\r\n          let data = res.data.data;\r\n          let pageDOM = document.createElement(\"div\");\r\n          pageDOM.innerHTML = this.renderCommentItem(data.records);\r\n          this.element.appendChild(pageDOM);\r\n          if (data.page * data.pageSize < data.total) {\r\n            this.element.appendChild(this.moreDOM);\r\n          }\r\n          scheduleMeasure();\r\n        }\r\n      });\r\n  }\r\n\r\n  private renderCommentItem(list: KBCommentItem[], first: number = 0): string {\r\n    return list.reduce((html: string, item: KBCommentItem) => {\r\n      let pid = first == 0 ? item.id : first;\r\n      html += `\r\n\t\t\t\t<div class=\"comment-item\">\r\n\t\t\t\t\t<div class=\"comment-avatar\">\r\n\t\t\t\t\t\t<img src=\"https://s.gravatar.com/avatar/${md5(item.mail)}?s=50&d=retro&r=g\" />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"comment-message clear-right\">\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<div class=\"comment-time\">${timeAgo(item.createdAt)}</div>\r\n\t\t\t\t\t\t\t<div class=\"comment-nickname\"><a target=\"_black\" href=\"${item.site}\">${item.nickName}</a></div>\r\n\t\t\t\t\t\t</div>\r\n            <div class=\"comment-content\">${item.content}</div>\r\n            <div class=\"comment-option\"><a class=\"reply-btn\" data-rid=\"${item.id}\" data-pid=\"${pid}\" href=\"javascript:\">回复</a></div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"comment-replys\">\r\n\t\t\t\t\t\t${Array.isArray(item.replys) ? this.renderCommentItem(item.replys, pid) : \"\"}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>`;\r\n      return html;\r\n    }, \"\");\r\n  }\r\n}\r\n","export function deparam(query: string): Record<string, string> {\r\n  let match: RegExpExecArray | null;\r\n  const plus = /\\+/g;\r\n  const search = /([^&=]+)=?([^&]*)/g;\r\n  const decode = (s: string) => decodeURIComponent(s.replace(plus, ' '));\r\n  const params: Record<string, string> = {};\r\n  // tslint:disable-next-line:no-conditional-assignment\r\n  while (match = search.exec(query)) {\r\n    params[decode(match[1])] = decode(match[2]);\r\n  }\r\n  return params;\r\n}\r\n\r\nexport function param(obj: Record<string, string>) {\r\n  const parts = [];\r\n  for (const name in obj) {\r\n    if (obj.hasOwnProperty(name) && obj[name]) {\r\n      parts.push(`${encodeURIComponent(name)}=${encodeURIComponent(obj[name])}`);\r\n    }\r\n  }\r\n  return parts.join('&');\r\n}","import { KBCommentComponent } from \"./comment-component\";\r\nimport { KBTimeLineComponent } from \"./timeline-component\";\r\nimport { deparam } from \"./deparam\";\r\nimport { startMeasuring } from \"./measure\";\r\nclass KBComment {\r\n  private container!: HTMLElement;\r\n  private commentComponent?: KBCommentComponent;\r\n  private timelineComponent?: KBTimeLineComponent;\r\n  private config: KBCommentConfig = {\r\n    theme: \"light\",\r\n    token: \"\",\r\n  };\r\n\r\n  constructor() {\r\n    this.container = document.createElement(\"div\");\r\n    document.body.appendChild(this.container);\r\n    let params = deparam(location.search.replace(\"?\", \"\"));\r\n    if (!this.container) {\r\n      console.error(\"未设定渲染容器\");\r\n    }\r\n    startMeasuring(params.origin);\r\n    this.container.className = \"kb-comment-container\";\r\n    this.config.theme = params.theme || \"light\";\r\n    this.config.token = params.token || location.pathname;\r\n    this.load().then(() => {\r\n      this.commentComponent = new KBCommentComponent(this.config);\r\n      this.container?.appendChild(this.commentComponent.element);\r\n      this.timelineComponent = new KBTimeLineComponent(this.config);\r\n      this.container?.appendChild(this.timelineComponent.element);\r\n      this.timelineComponent.getList();\r\n      let self = this;\r\n      this.commentComponent.setEvent(function () {\r\n        self.timelineComponent?.getList();\r\n      });\r\n    });\r\n  }\r\n\r\n  private load(): Promise<any> {\r\n    return Promise.all([this.loadTheme()]);\r\n  }\r\n\r\n  private loadTheme() {\r\n    return new Promise((resolve) => {\r\n      const link = document.createElement(\"link\");\r\n      link.rel = \"stylesheet\";\r\n      link.setAttribute(\"crossorigin\", \"anonymous\");\r\n      link.onload = resolve;\r\n      link.href = `./static/themes/${this.config.theme}.css`;\r\n      document.head.appendChild(link);\r\n    });\r\n  }\r\n}\r\n\r\nnew KBComment();\r\n"]}