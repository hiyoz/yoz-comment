{"version":3,"sources":["static/deparam.ts","client.ts"],"names":[],"mappings":"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","file":"client.js","sourceRoot":"..\\client","sourcesContent":["export function deparam(query: string): Record<string, string> {\r\n  let match: RegExpExecArray | null;\r\n  const plus = /\\+/g;\r\n  const search = /([^&=]+)=?([^&]*)/g;\r\n  const decode = (s: string) => decodeURIComponent(s.replace(plus, ' '));\r\n  const params: Record<string, string> = {};\r\n  // tslint:disable-next-line:no-conditional-assignment\r\n  while (match = search.exec(query)) {\r\n    params[decode(match[1])] = decode(match[2]);\r\n  }\r\n  return params;\r\n}\r\n\r\nexport function param(obj: Record<string, string>) {\r\n  const parts = [];\r\n  for (const name in obj) {\r\n    if (obj.hasOwnProperty(name) && obj[name]) {\r\n      parts.push(`${encodeURIComponent(name)}=${encodeURIComponent(obj[name])}`);\r\n    }\r\n  }\r\n  return parts.join('&');\r\n}","import { param } from \"./static/deparam\";\r\nimport { ResizeMessage } from \"./static/measure\";\r\nlet script = document.currentScript as HTMLScriptElement;\r\nif (script === undefined) {\r\n  script = document.querySelector(\"script#YozComment\") as HTMLScriptElement;\r\n}\r\n\r\nlet attrs: Record<string, string> = {};\r\nfor (let i = 0; i < script.attributes.length; i++) {\r\n  let attr = script.attributes.item(i)!;\r\n  attrs[attr.name.replace(/^data-/, \"\")] = attr.value;\r\n}\r\nattrs.origin = location.origin;\r\nattrs.title = document.title;\r\nattrs.url = location.href;\r\ndocument.head.insertAdjacentHTML(\r\n  \"afterbegin\",\r\n  `<style>\r\n\t\t\t.yozComment {\r\n\t\t\t\tposition: relative;\r\n\t\t\t\tbox-sizing: border-box;\r\n\t\t\t\twidth: 100%;\r\n\t\t\t\tmax-width: 760px;\r\n\t\t\t\tmargin-left: auto;\r\n\t\t\t\tmargin-right: auto;\r\n\t\t\t}\r\n\t\t\t.yozComment-frame {\r\n\t\t\t\tcolor-scheme: light;\r\n\t\t\t\tposition: absolute;\r\n\t\t\t\tleft: 0;\r\n\t\t\t\tright: 0;\r\n\t\t\t\twidth: 1px;\r\n\t\t\t\tmin-width: 100%;\r\n\t\t\t\tmax-width: 100%;\r\n\t\t\t\theight: 100%;\r\n\t\t\t\tborder: 0;\r\n\t\t\t}\r\n\t\t</style>`\r\n);\r\n// let origin = script.src.replace(/client.js$/, \"index.html\");\r\nlet pathArray = script.src.split(\"/\");\r\nlet urlOrigin = pathArray[0] + \"//\" + pathArray[2];\r\nlet url = script.src.replace(/client.js$/, \"index.html\");\r\nscript.insertAdjacentHTML(\r\n  \"afterend\",\r\n  `<div class=\"yozComment\">\r\n    <iframe class=\"yozComment-frame\" title=\"Comments\" scrolling=\"no\" src=\"${url}?${param(attrs)}\" loading=\"lazy\"></iframe>\r\n  </div>`\r\n);\r\nconst container = script.nextElementSibling as HTMLDivElement;\r\nscript.parentElement!.removeChild(script);\r\n\r\n// adjust the iframe's height when the height of it's content changes\r\naddEventListener(\"message\", (event) => {\r\n  if (event.origin !== urlOrigin) {\r\n    return;\r\n  }\r\n  const data = event.data as ResizeMessage;\r\n  if (data && data.type === \"resize\" && data.height) {\r\n    container.style.height = `${data.height}px`;\r\n  }\r\n});\r\n"]}